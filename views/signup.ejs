<%- include('partials/header'); -%>
   <!--

<form>
        <h2>Sign up</h2>
        <label for="email">Email</label>
        <input type="text" name="email" required>
        <div class="email error"></div>
        <label for="password">Password</label> 
        <input type="password" name="password">
        <div class="password error"></div>
        <button>Sign up</button>
    </form>


   --> 


   <!--  

  <div class="form-container">

    <form >
       <h3>register now</h3>
   
       <input type="email" name="email" required placeholder="entrer votre email">
       <div style="color: rgb(231, 19, 19);" class="email error"></div>
       <input type="password" name="password" required placeholder="enter your password">
       <div style="color: rgb(231, 19, 19);" class="password error"></div>
       <button class="btn" style="font-size: 30px; color: white; background-color: brown; border-radius: 10px; width: 100px; margin-top: 10px; margin-right: 10px;" >login</button>
       <p>Vous avez un compte? <a href="/login">login now</a></p>
    </form>
 
 </div>
   
   
    <script>
        const form = document.querySelector('form')

        const emailError = document.querySelector('.email.error');
        const passwordError = document.querySelector('.password.error');


        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // reset error

            emailError.textContent = '';
            passwordError.textContent = '';

            //get the value
            const email = form.email.value;
            const password = form.password.value;


            try {
                const res = await fetch('/signup', {
                    method: 'POST',
                    body: JSON.stringify({ email, password }),
                    headers: { 'content-type': 'application/json' }
                });

                const data = await res.json()
                console.log(data);

                if (data.errors) {
                    emailError.textContent = data.errors.email;
                    passwordError.textContent = data.errors.password;
                }

                if (data.user) {
                    location.assign('/smoothies');
                }

            } catch (error) {
                console.log(error)
            }
        })
    </script>


   -->

   <%- include('partials/header'); -%>

<style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

body {
  font-family: 'Roboto', sans-serif;
}
    form {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
      border-radius: 5px;
      animation: fade-in 0.5s ease-in-out;
    }
  
    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
  
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
  
    input[type="text"],
    input[type="password"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
  
    .error {
      color: red;
      margin-bottom: 10px;
      animation: shake 0.3s ease-in-out;
    }
  
    @keyframes shake {
      0% {
        transform: translateX(0);
      }
      20% {
        transform: translateX(-5px);
      }
      40% {
        transform: translateX(5px);
      }
      60% {
        transform: translateX(-5px);
      }
      80% {
        transform: translateX(5px);
      }
      100% {
        transform: translateX(0);
      }
    }
  
    button {
      display: block;
      width: 100%;
      padding: 10px;
      background-color: #4caf50;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease-in-out;
    }
  
    button:hover {
      background-color: #45a049;
    }
  </style>
   <form>
    <h2>Sign up</h2>
    <label for="text">Nom Etudiant</label>
    <input name="name" type="text" required>
    <label for="email">Email</label>
    <input type="text" name="email" required>
    <div class="email error"></div>
    <label for="text">Matricule</label>
    <input name="numero" type="text" class="form-control">
    <div class="numero error"></div>
    <label for="image">Votre image</label>
    <input name="image" type="file" required>
    <div class="image error"></div>
    <label for="password">Password</label>
    <input type="password" name="password">
    <div class="password error"></div>
    <button>Sign up</button>
  </form>
  
  <script>
    const form = document.querySelector('form');
    const emailError = document.querySelector('.email.error');
    const passwordError = document.querySelector('.password.error');
    const numeroError = document.querySelector('.numero.error');
    const imageError = document.querySelector('.image.error');
  
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
  
      // Reset des erreurs
      emailError.textContent = '';
      passwordError.textContent = '';
      numeroError.textContent = '';
      imageError.textContent = '';
  
      // Récupération des valeurs des champs
      const name = form.name.value;
      const email = form.email.value;
      const numero = form.numero.value;
      const image = form.image.files[0]; // Récupère le premier fichier sélectionné
      const password = form.password.value;
  
      // Vérification de la longueur du numéro de compteur
      if (numero.length !== 12) {
        numeroError.textContent = 'Le numéro de compteur doit avoir 12 caractères.';
        return;
      }
  
      // Vérification si un fichier image est sélectionné
      if (!image) {
        imageError.textContent = 'Veuillez sélectionner une image.';
        return;
      }
  
      try {
        const formData = new FormData();
        formData.append('name', name);
        formData.append('email', email);
        formData.append('numero', numero);
        formData.append('image', image);
        formData.append('password', password);
  
        const res = await fetch('/signup', {
          method: 'POST',
          body: formData
        });
  
        const data = await res.json();
        console.log(data);
  
        if (data.errors) {
          emailError.textContent = data.errors.email;
          passwordError.textContent = data.errors.password;
        }
  
        if (data.user) {
          location.assign('smoothies');
        }
      } catch (error) {
        console.log(error);
      }
    });
  </script>
    

    <%- include('partials/footer'); -%>
 

